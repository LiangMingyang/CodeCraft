<nav class="navbar navbar-default" ng-include="'detail/nav.html'"></nav>


<div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
    <h4>{{Contest.data.title}}</h4>
    <div class="form-horizontal">
        <a class = "normal-color list-group-item" href="#/{{contestId}}" >简介</a>
        <a ng-if="Contest.data.start_time < ServerTime.data" class = "normal-color list-group-item" href="#/{{contestId}}/problems">题目</a>
        <a ng-if="Contest.data.start_time < ServerTime.data" class = "normal-color list-group-item active" href="#/{{contestId}}/rank">排名</a>
        <a ng-if="Contest.data.start_time < ServerTime.data" class = "normal-color list-group-item" href="#/{{contestId}}/submissions">我的提交</a>
        <a ng-if="Contest.data.start_time < ServerTime.data" class = "normal-color list-group-item" href="#/{{contestId}}/issues">提问&&公告</a>
    </div>
    <!--<div ng-show="isPage('problem')" ng-include="'detail/problem-left.html'">-->
    <!--</div>-->
    <div class="text-center" ng-include="'detail/time.html'"></div>
</div>


<div class="col-lg-10 col-md-10 col-sm-10 col-xs-12">
    <h3>
        比赛排名
        <small>
            更新中，上次更新于
            <code>
                {{Rank.version | date:"yyyy-MM-dd HH:mm:ss"}}
            </code>
        </small>
    </h3>
    <div>
        <div>
            <dir-pagination-controls boundary-links="true" template-url="detail/pagination/dirPagination.tpl.html" pagination-id="rank"
                auto-hide="false"></dir-pagination-controls>
        </div>
        <table class="table table-bordered table-condensed table-hover">
            <thead>
                <tr class="text-center">
                    <td>排名</td>
                    <td>
                        <label for="rank_user">用户</label>
                        <input id="rank_user" ng-model="Rank.query.user.nickname" class="form-control">
                    </td>
                    <td>得分</td>
                    <td>罚时</td>
                    <td ng-repeat="problem in Contest.data.problems">
                        <a ng-click="setProblem($index)" href="#/{{contestId}}/problems">{{numberToLetters($index)}}</a>
                        <!--<br>-->
                        <p>
                            {{Rank.statistics.acceptedPeopleCount[numberToLetters($index)]}}/{{Rank.statistics.triedPeopleCount[numberToLetters($index)]}}
                        </p>
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr dir-paginate="r in Rank.data | filter: Rank.query | itemsPerPage: 100" current-page="Rank.currentRankPage" pagination-id="rank" class="text-center">
                    <td>{{r.rank}}</td>
                    <td><a href="/user/{{r.user.id}}">{{r.user.nickname | limitTo:5}}</a></td>
                    <td>{{r.score}}</td>
                    <td>{{r.penalty | penalty}}</td>
                    <!-- TODO: there are some problems in the penalty: the hour is wrong. -->
                    <td ng-repeat="problem in Contest.data.problems"
                        ng-class = "{ 'danger': r.detail[numberToLetters($index)] && r.detail[numberToLetters($index)].result != 'AC' && r.detail[numberToLetters($index)].score === 0, 'success': r.detail[numberToLetters($index)] && r.detail[numberToLetters($index)].result == 'AC', 'info': r.detail[numberToLetters($index)] && r.detail[numberToLetters($index)].first_blood, 'warning': r.detail[numberToLetters($index)] && r.detail[numberToLetters($index)].result != 'AC' && r.detail[numberToLetters($index)].score > 0} "
                    >
                    {{r.detail[numberToLetters($index)].accepted_time | penalty}}{{r.detail[numberToLetters($index)].wrong_count | wrongCount}}
                    </td>
                </tr>
            </tbody>
        </table>
        <div>
            <dir-pagination-controls boundary-links="true" template-url="detail/pagination/dirPagination.tpl.html" pagination-id="rank"
                auto-hide="false"></dir-pagination-controls>
        </div>
        <!--{{rank}}-->
    </div>
</div>
